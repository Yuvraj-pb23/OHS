{% extends 'base.html' %}
{% load static %}

{% block body %}
<div class="posh-c-wrapper">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #ff9f43 0%, #ff6b6b 100%);
            --glass-bg: rgba(255, 255, 255, 0.05);
            --glass-border: rgba(255, 255, 255, 0.2);
            --highlight: #ff9f43;
        }

        .posh-c-wrapper {
            margin: 0; padding: 0; box-sizing: border-box;
            font-family: 'Poppins', sans-serif;
            min-height: 100vh; width: 100%;
            display: flex; justify-content: center; align-items: center;
            background: url("{% static 'img/footer-logo.png' %}") no-repeat center center;
            background-size: contain; position: relative;
        }

        .posh-c-wrapper::before {
            content: ''; position: absolute; inset: 0;
            background: rgba(26, 37, 51, 0.9);
            backdrop-filter: blur(4px); z-index: 0;
        }

        .glass-card {
            position: relative; z-index: 1; width: 450px; padding: 40px;
            border-radius: 24px; background: var(--glass-bg);
            backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5); color: white;
        }

        .header { text-align: center; margin-bottom: 25px; }
        .header h2 { font-size: 1.8rem; font-weight: 700; }
        .header p { font-size: 0.9rem; opacity: 0.7; }

        .calculator-box { background: rgba(0,0,0,0.2); padding: 20px; border-radius: 15px; margin-bottom: 25px; }
        .input-group { display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; }
        .num-input {
            width: 100px; padding: 8px; background: rgba(255,255,255,0.15);
            border: 1px solid var(--highlight); border-radius: 8px;
            color: white; font-weight: 700; text-align: center; font-size: 1.1rem; outline: none;
        }

        .range-slider {
            -webkit-appearance: none; width: 100%; height: 6px;
            border-radius: 5px; background: rgba(255,255,255,0.2); outline: none;
        }
        .range-slider::-webkit-slider-thumb {
            -webkit-appearance: none; width: 20px; height: 20px;
            border-radius: 50%; background: var(--highlight);
            box-shadow: 0 0 10px rgba(255, 159, 67, 0.7);
        }

        .total-price { text-align: center; margin-top: 15px; }
        .price-display { font-size: 3rem; font-weight: 700; color: var(--highlight); line-height: 1; }
        .price-display span { font-size: 1.5rem; vertical-align: top; }
        .duration { font-size: 0.9rem; opacity: 0.7; display: block; margin-top: 5px;}

        .features { margin: 25px 0; border-top: 1px solid var(--glass-border); padding-top: 20px; }
        .features ul { list-style: none; padding: 0; }
        .features li { margin-bottom: 12px; font-size: 0.9rem; display: flex; align-items: center; }
        .features li i { color: var(--highlight); margin-right: 12px; width: 20px; text-align: center; }

        .btn-buy {
            width: 100%; padding: 16px; border: none; border-radius: 50px;
            background: linear-gradient(45deg, #ff9f43, #ff6b6b); color: white;
            font-weight: 700; font-size: 1rem; cursor: pointer; text-transform: uppercase;
            display: block; text-align: center; text-decoration: none;
        }
        .btn-buy:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(255, 107, 107, 0.4); }
    </style>

    <div class="glass-card">
        <div class="header">
            <h2>Individual POCSO Plan</h2>
            <p>Child Protection & Legal Awareness</p>
        </div>

        <div class="calculator-box">
            <div class="input-group">
                <label>Number of Licenses:</label>
                <input type="number" id="numInput" class="num-input" value="1" min="1">
            </div>
            <input type="range" id="rangeInput" class="range-slider" min="1" max="100" value="1">

            <div class="total-price">
                <div class="calculation-text" id="mathText">1 license x ₹1,000</div>
                <div class="price-display">
                    <span>₹</span><span id="finalPrice">1,000</span>
                </div>
                <span class="duration">Annual Training Access</span>
            </div>
        </div>

        <div class="features">
            <ul>
                <li><i class="fa-solid fa-shield-cat"></i> Child Safety Certification</li>
                <li><i class="fa-solid fa-gavel"></i> Understanding Section 19</li>
                <li><i class="fa-solid fa-briefcase-medical"></i> Mandatory Reporting Guides</li>
                <li><i class="fa-solid fa-mobile-screen"></i> Mobile-Friendly Learning</li>
            </ul>
        </div>

        <button class="btn-buy" onclick="proceedToCheckout()">
            Start Learning
        </button>
    </div>
</div>

<script>
    const rangeInput = document.getElementById('rangeInput');
    const numInput = document.getElementById('numInput');
    const finalPrice = document.getElementById('finalPrice');
    const mathText = document.getElementById('mathText');
    const COST_PER_UNIT = 1000;

    const formatCurrency = (num) => new Intl.NumberFormat('en-IN').format(num);

    function updateCalculator(val) {
        let count = parseInt(val) || 1;
        rangeInput.value = count;
        numInput.value = count;
        const total = count * COST_PER_UNIT;
        finalPrice.innerText = formatCurrency(total);
        mathText.innerText = `${count} license x ₹${formatCurrency(COST_PER_UNIT)}`;
    }

    rangeInput.addEventListener('input', (e) => updateCalculator(e.target.value));
    numInput.addEventListener('input', (e) => updateCalculator(e.target.value));

    function proceedToCheckout() {
        const seats = document.getElementById('numInput').value;
        const baseUrl = "{% url 'individual_subscription' 'POCSO' %}";
        window.location.href = `${baseUrl}?seats=${seats}`;
    }
</script>
{% endblock body %}